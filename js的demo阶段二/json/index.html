<!--
 * @Date: 2021-05-27 19:35:29
 * @LastEditors: LaBiXiaoChen
 * @LastEditTime: 2021-05-27 20:27:18
 * @FilePath: \js的demo阶段二\json\index.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // 1.json的简单值形式对应着js中的基本数据类型
        // 注意事项
        // 支持数字，字符串，布尔，null。但是不支持undefined
        //json中必须使用双引号
        // json是不能有注释的


        // 访问本地json文件
        const xhr1 = new XMLHttpRequest();

        xhr1.onreadystatechange = () => {
            if (xhr1.readyState !== 4) return;
            if ((xhr1.status >= 200 && xhr1.status <= 300) || xhr1.status === 304) {
                console.log(JSON.parse(xhr1.responseText));
            }
        }

        xhr1.open('GET', './简单形式.json', true);
        xhr1.send(null);

        //2.json对象形式对应着js中的对象

        const xhr2 = new XMLHttpRequest();

        xhr2.onreadystatechange = () => {
            if (xhr2.readyState !== 4) return;
            if ((xhr2.status >= 200 && xhr2.status <= 300) || xhr2.status === 304) {
                console.log(JSON.parse(xhr2.responseText));
            }
        }

        xhr2.open('GET', './对象形式.json', true);
        xhr2.send(null);

        //3.json数组形式对应着js中的数组

        const xhr3 = new XMLHttpRequest();

        xhr3.onreadystatechange = () => {
            if (xhr3.readyState !== 4) return;
            if ((xhr3.status >= 200 && xhr3.status <= 300) || xhr3.status === 304) {
                console.log(JSON.parse(xhr3.responseText));
            }
        }

        xhr3.open('GET', './数组形式.json', true);
        xhr3.send(null);

        // 实际上，你在json文件中写了一些不合法的undefined，一样可以传输过去，因为ajax的转码，但是在json解析过程中必须支持完全正确的格式，所以写json的时候必须写正确


        // js中常用json方法
        // JSON.parse()可以将json格式的字符串解析成js中对应的对应值
        // 方法使用添加到上面的函数中去了

        // JSON.stringify()可以将js中的形式转换为json格式
        const url = `https://www.imooc.com/api/http/search/suggest?words=js`;
        const xhr4 = new XMLHttpRequest();

        // 手写一个对象，想要用这个对象转换成json发送到服务器上面去
        const jsonText = {
            name: "xiaochen",
            age: 10
        };

        xhr4.onreadystatechange = () => {
            if (xhr4.readyState !== 4) return;
            if ((xhr4.status >= 200 && xhr4.status <= 300) || xhr4.status === 304) {
                console.log(xhr4.responseText);
            }
        }
        xhr4.open('POST', url, true);
        xhr4.send(JSON.stringify(jsonText)); //{"name":"xiaochen","age":10} 查看了浏览器network中的请求的结果
    </script>

    <script type="module">
        import {set ,get,remove,clearAll} from './使用json方法来封装localStorage.js';

        set('name','xiaochen');
        set('family',{mam :'xiaoli',dad:'xiaochenchen'})
        // 删除和清空就不测试了，功能和原生代码基本没区别，详情查看js源文件
    </script>
</body>

</html>