<!--
 * @Date: 2021-05-30 23:14:53
 * @LastEditors: LaBiXiaoChen
 * @LastEditTime: 2021-05-30 23:36:35
 * @FilePath: \js的demo阶段二\Fetch\index.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        const url = `https://www.imooc.com/api/http/search/suggest?words=js`;

        console.log(fetch); //ƒ fetch() { [native code] }

        // fetch除了第一个参数还有第二个参数
        fetch(url, {
                method: 'POST',
                body: 'name=xiaochen;age=10;xiaoming=12'
            })
            .then(response => {
                console.log(response);
                // fetch中读取数据是在body中的可读的流，但是只能读取一次，读取完之后就不能再次读取了
                // ok属性进行响应状态的判断，如果ok属性是true的话，就不需要再去判断状态码了
                if (response.ok) {
                    // console.log(response.json());//报错了，读了两次
                    return response.json();
                    // 除了json格式的，还可以使用
                    // return response.text();
                } else {
                    throw new Error(`请求未成功！HTTP CODE异常${response.status}`);
                }
            })
            .then(data => {
                console.log(data.data);
            })
            .catch(err => {
                console.log(err);
            });
    </script>
</body>

</html>